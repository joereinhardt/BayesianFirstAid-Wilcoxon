---
title: "A Bayesian Alternative to the Wilcoxon Rank Test"
author: "Joachim Reinhardt"
date: "`r Sys.Date()`"
output: rmarkdown::html_vignette
bibliography: Rbibliography.bib
vignette: >
  %\VignetteIndexEntry{A Bayesian Alternative to the Wilcoxon Rank Test}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---

The **wilcox_test** R-package implements a Bayesian Alternative to the Wilcoxon 
Signed Rank test and is intended as an addition to the **BayesianFirstAid** 
package [@baath2014bayesian]. The approach follows [@gelman2014bayesian, p. 97],
who  suggest a three-step methodology for a Bayesian approach to the Wilcoxon 
test. Following this methodology, the **wilcox.test** function first transforms 
the combined input data to their ranks as in the conventional Wilcoxon 
procedure. Then, these ranks are normalized into z-scores, and the difference 
between the two groups is modeled as a normal distribution with uninformative 
priors. This approach has the following advantages: ... 

Note: Consider Mann-Whitney Test! -> test for two independent groups, also
included in wilcox.test function

Gelman (blog post): "the Wilcoxon test has a huge assumption which is that the 
distributions are identical in the two groups. This is a much more important 
assumption than normality."

"History of the idea": [@van1953neuer] introduced concept, but used equidistant
points instead of quantiles. [@gelman2014bayesian, p. 97] using quantiles

[@kruschke2013bayesian, p. 575]: "In the case of data from a single
group, including the case of a single group of difference scores
from repeated measures on the same subjects, a modified model
merely estimates $\mu$, $\sigma$, and $\nu$ of the group." Crucial change from
independent two paired sample test: two different $\sigma$s vs. a single one
See Kruschke's 2011 discussion of oneway / twoway ANOVA!

Consider including effect size / How to deal with mu?


## Prior Distributions
(Two-sample case first)  

One-sample case: Assuming $\mu_{diff}$ to come from $N(\mu, 1)$ distribution.
Thus, a prior is needed only for $\mu$. Maximum and Minimum value of 
$\mu_{diff}$:
Occur when all values from sample $x$ are larger than the values from sample
$y$. Figure out Min. / Max. by Simulation:  

Generate $n$ nonequal values for $x$ and $y$, where $x_i > y_i$ for all $i$.
Perform rank-z-score transform and calculate the mean z-score for $x$ and $y$:  
$\bar{z}_x = \frac{1}{n} \sum^n_{i=1} z_{x_i}$, equivalently for $y$. For large
$n$, $\bar{z}_x-\bar{z}_y \to 1.5958$. Exchanging $x$ and $y$ leads to 
$\bar{z}_y - \bar{z}_x \to -1.5958$. Employing a uniformly distributed prior,
the prior for $\mu_{diff}$ is $Unif(-1.5958, 1.5958)$. (Check if there is a
more flexible $Beta$-representation)

For two sample case:  
$\mu_x$ and $\mu_y$ come from separate $N(\mu, \sigma)$ distributions -- priors
are needed for both $\mu$ and $\sigma$. From simulation, large $n$: 
$\bar{z}_x \to 0.7979$, $\bar{z}_y \to -0.7979$. Thus, priors for $\mu_x$ and
$\mu_y$ are set to $Unif(-0.7979, 0.7979)$.  
For priors on $\sigma$, the simulation should also give the lower limit for 
possible values of $\sigma$ (is this true?). Results give  
$\sigma_{x_L} = \sigma_{y_L} \to 0.6028$. The upper limit is given by 
$\sigma_H = 1$, if $x$ and $y$ are "maximally distributed" within the $N(0,1)$
parent distribution. Priors for $\sigma$ thus set to $Unif(0.6027, 1)$.  



## Introduction

Note the various macros within the `vignette` section of the metadata block above. These are required in order to instruct R how to build the vignette. Note that you should change the `title` field and the `\VignetteIndexEntry` to match the title of your vignette.

## A Bayesian Alternative to the Wilcoxon

### The frequentist Wilcoxon Test



## Literature Overview

[@gelman2011bayesian, p.11]: "Even the Wilcoxon Test is based on assumptions!"

## Figures

The figure sizes have been customised so that you can easily put two images side-by-side. 

```{r, fig.show='hold'}
plot(1:10)
plot(10:1)
```

You can enable figure captions by `fig_caption: yes` in YAML:

    output:
      rmarkdown::html_vignette:
        fig_caption: yes

Then you can use the chunk option `fig.cap = "Your figure caption."` in **knitr**.

## More Examples

You can write math expressions, e.g. $Y = X\beta + \epsilon$, footnotes^[A footnote here.], and tables, e.g. using `knitr::kable()`.

```{r, echo=FALSE, results='asis'}
knitr::kable(head(mtcars, 10))
```

Also a quote using `>`:

> "He who gives up [code] safety for [code] speed deserves neither."
([via](https://twitter.com/hadleywickham/status/504368538874703872))

## References
