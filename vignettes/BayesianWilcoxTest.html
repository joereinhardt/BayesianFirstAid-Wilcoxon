<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />

<meta name="viewport" content="width=device-width, initial-scale=1">

<meta name="author" content="Joachim Reinhardt" />

<meta name="date" content="2018-04-23" />

<title>A Bayesian Alternative to the Wilcoxon Rank Test</title>



<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
</style>



<link href="data:text/css;charset=utf-8,body%20%7B%0Abackground%2Dcolor%3A%20%23fff%3B%0Amargin%3A%201em%20auto%3B%0Amax%2Dwidth%3A%20700px%3B%0Aoverflow%3A%20visible%3B%0Apadding%2Dleft%3A%202em%3B%0Apadding%2Dright%3A%202em%3B%0Afont%2Dfamily%3A%20%22Open%20Sans%22%2C%20%22Helvetica%20Neue%22%2C%20Helvetica%2C%20Arial%2C%20sans%2Dserif%3B%0Afont%2Dsize%3A%2014px%3B%0Aline%2Dheight%3A%201%2E35%3B%0A%7D%0A%23header%20%7B%0Atext%2Dalign%3A%20center%3B%0A%7D%0A%23TOC%20%7B%0Aclear%3A%20both%3B%0Amargin%3A%200%200%2010px%2010px%3B%0Apadding%3A%204px%3B%0Awidth%3A%20400px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Aborder%2Dradius%3A%205px%3B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Afont%2Dsize%3A%2013px%3B%0Aline%2Dheight%3A%201%2E3%3B%0A%7D%0A%23TOC%20%2Etoctitle%20%7B%0Afont%2Dweight%3A%20bold%3B%0Afont%2Dsize%3A%2015px%3B%0Amargin%2Dleft%3A%205px%3B%0A%7D%0A%23TOC%20ul%20%7B%0Apadding%2Dleft%3A%2040px%3B%0Amargin%2Dleft%3A%20%2D1%2E5em%3B%0Amargin%2Dtop%3A%205px%3B%0Amargin%2Dbottom%3A%205px%3B%0A%7D%0A%23TOC%20ul%20ul%20%7B%0Amargin%2Dleft%3A%20%2D2em%3B%0A%7D%0A%23TOC%20li%20%7B%0Aline%2Dheight%3A%2016px%3B%0A%7D%0Atable%20%7B%0Amargin%3A%201em%20auto%3B%0Aborder%2Dwidth%3A%201px%3B%0Aborder%2Dcolor%3A%20%23DDDDDD%3B%0Aborder%2Dstyle%3A%20outset%3B%0Aborder%2Dcollapse%3A%20collapse%3B%0A%7D%0Atable%20th%20%7B%0Aborder%2Dwidth%3A%202px%3B%0Apadding%3A%205px%3B%0Aborder%2Dstyle%3A%20inset%3B%0A%7D%0Atable%20td%20%7B%0Aborder%2Dwidth%3A%201px%3B%0Aborder%2Dstyle%3A%20inset%3B%0Aline%2Dheight%3A%2018px%3B%0Apadding%3A%205px%205px%3B%0A%7D%0Atable%2C%20table%20th%2C%20table%20td%20%7B%0Aborder%2Dleft%2Dstyle%3A%20none%3B%0Aborder%2Dright%2Dstyle%3A%20none%3B%0A%7D%0Atable%20thead%2C%20table%20tr%2Eeven%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0Ap%20%7B%0Amargin%3A%200%2E5em%200%3B%0A%7D%0Ablockquote%20%7B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Apadding%3A%200%2E25em%200%2E75em%3B%0A%7D%0Ahr%20%7B%0Aborder%2Dstyle%3A%20solid%3B%0Aborder%3A%20none%3B%0Aborder%2Dtop%3A%201px%20solid%20%23777%3B%0Amargin%3A%2028px%200%3B%0A%7D%0Adl%20%7B%0Amargin%2Dleft%3A%200%3B%0A%7D%0Adl%20dd%20%7B%0Amargin%2Dbottom%3A%2013px%3B%0Amargin%2Dleft%3A%2013px%3B%0A%7D%0Adl%20dt%20%7B%0Afont%2Dweight%3A%20bold%3B%0A%7D%0Aul%20%7B%0Amargin%2Dtop%3A%200%3B%0A%7D%0Aul%20li%20%7B%0Alist%2Dstyle%3A%20circle%20outside%3B%0A%7D%0Aul%20ul%20%7B%0Amargin%2Dbottom%3A%200%3B%0A%7D%0Apre%2C%20code%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0Aborder%2Dradius%3A%203px%3B%0Acolor%3A%20%23333%3B%0Awhite%2Dspace%3A%20pre%2Dwrap%3B%20%0A%7D%0Apre%20%7B%0Aborder%2Dradius%3A%203px%3B%0Amargin%3A%205px%200px%2010px%200px%3B%0Apadding%3A%2010px%3B%0A%7D%0Apre%3Anot%28%5Bclass%5D%29%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0Acode%20%7B%0Afont%2Dfamily%3A%20Consolas%2C%20Monaco%2C%20%27Courier%20New%27%2C%20monospace%3B%0Afont%2Dsize%3A%2085%25%3B%0A%7D%0Ap%20%3E%20code%2C%20li%20%3E%20code%20%7B%0Apadding%3A%202px%200px%3B%0A%7D%0Adiv%2Efigure%20%7B%0Atext%2Dalign%3A%20center%3B%0A%7D%0Aimg%20%7B%0Abackground%2Dcolor%3A%20%23FFFFFF%3B%0Apadding%3A%202px%3B%0Aborder%3A%201px%20solid%20%23DDDDDD%3B%0Aborder%2Dradius%3A%203px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Amargin%3A%200%205px%3B%0A%7D%0Ah1%20%7B%0Amargin%2Dtop%3A%200%3B%0Afont%2Dsize%3A%2035px%3B%0Aline%2Dheight%3A%2040px%3B%0A%7D%0Ah2%20%7B%0Aborder%2Dbottom%3A%204px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Apadding%2Dbottom%3A%202px%3B%0Afont%2Dsize%3A%20145%25%3B%0A%7D%0Ah3%20%7B%0Aborder%2Dbottom%3A%202px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Afont%2Dsize%3A%20120%25%3B%0A%7D%0Ah4%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23f7f7f7%3B%0Amargin%2Dleft%3A%208px%3B%0Afont%2Dsize%3A%20105%25%3B%0A%7D%0Ah5%2C%20h6%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23ccc%3B%0Afont%2Dsize%3A%20105%25%3B%0A%7D%0Aa%20%7B%0Acolor%3A%20%230033dd%3B%0Atext%2Ddecoration%3A%20none%3B%0A%7D%0Aa%3Ahover%20%7B%0Acolor%3A%20%236666ff%3B%20%7D%0Aa%3Avisited%20%7B%0Acolor%3A%20%23800080%3B%20%7D%0Aa%3Avisited%3Ahover%20%7B%0Acolor%3A%20%23BB00BB%3B%20%7D%0Aa%5Bhref%5E%3D%22http%3A%22%5D%20%7B%0Atext%2Ddecoration%3A%20underline%3B%20%7D%0Aa%5Bhref%5E%3D%22https%3A%22%5D%20%7B%0Atext%2Ddecoration%3A%20underline%3B%20%7D%0A%0Acode%20%3E%20span%2Ekw%20%7B%20color%3A%20%23555%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Edt%20%7B%20color%3A%20%23902000%3B%20%7D%20%0Acode%20%3E%20span%2Edv%20%7B%20color%3A%20%2340a070%3B%20%7D%20%0Acode%20%3E%20span%2Ebn%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Efl%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Ech%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Est%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Eco%20%7B%20color%3A%20%23888888%3B%20font%2Dstyle%3A%20italic%3B%20%7D%20%0Acode%20%3E%20span%2Eot%20%7B%20color%3A%20%23007020%3B%20%7D%20%0Acode%20%3E%20span%2Eal%20%7B%20color%3A%20%23ff0000%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Efu%20%7B%20color%3A%20%23900%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%20code%20%3E%20span%2Eer%20%7B%20color%3A%20%23a61717%3B%20background%2Dcolor%3A%20%23e3d2d2%3B%20%7D%20%0A" rel="stylesheet" type="text/css" />

</head>

<body>




<h1 class="title toc-ignore">A Bayesian Alternative to the Wilcoxon Rank Test</h1>
<h4 class="author"><em>Joachim Reinhardt</em></h4>
<h4 class="date"><em>2018-04-23</em></h4>



<p>The <strong>bayesWilcoxTest</strong> R-package implements a Bayesian Alternative to the classical Wilcoxon Rank test and is intended as an addition to the <strong>BayesianFirstAid</strong> package <span class="citation">(Bååth 2014)</span>. As in the original Wilcoxon test, the data are substituted by their ranks. Following <span class="citation">Gelman et al. (2014)</span>, p. 97, the ranks are then transformed to the quantiles of a standard Gaussian distribution. This allows modeling the transformed data as a Gaussian distribution via Bayesian methods with uninformative priors. The resulting posterior distribution can be interpreted similarly to the classical hypothesis test, but provides more detailed information and has a more straightforward interpretation.<br />
The package implements a paired and independent sample test.</p>
<div id="introduction" class="section level2">
<h2>Introduction</h2>
<p>In a frequentist framework, hypothesis testing is performed in a way that is distinct from other forms of inference, such as parameter estimation. In a frequentist hypothesis test, the compability of the observed data with a given hypothesis on model parameters is assessed, while parameter estimation - for example by maximum likelihood methods - is concerned with finding the parameter estimate most compatible with the given data. In probability notation, frequentist hypothesis tests evaluate <span class="math inline">\(P(y|\theta_0)\)</span>, known as the p-value - i.e. the probability of obtaining the observed data <span class="math inline">\(y\)</span> under the assumption that the model under the null hypothesis, with parameters <span class="math inline">\(\theta_0\)</span>, is the true process by which the data are generated. Frequentist maximum likelihood parameter estimation operates by finding the value of <span class="math inline">\(\theta\)</span> for which the likelihood <span class="math inline">\({\cal L}(\theta|y)\)</span> given the observed data is maximal, which corresponds to the parameter with a p-value of <span class="math inline">\(1\)</span>, or <span class="math inline">\(P(y|\theta) = 1\)</span>.</p>
<p>From a Bayesian perspective, parameter estimates and hypothesis tests on parameters both involve the same estimation procedure. The outcome of Bayesian model estimation is a full probability distribution of the parameters in question, the posterior distribution <span class="math inline">\(P(\theta|y)\)</span>. This posterior distribution can directly be employed to test hypotheses on the parameters at hand.</p>
<p>One way of doing so are Bayes factors, which compare the posterior distributions of two models, usually under a null and an alternative hypothesis. The ratio of both posterior distributions indicates which model can be considered likely given the observed data. A major difference to frequentist hypothesis tests is that evidence both for and against the null hypothesis is considered; thus, the equivalent of “accepting” the null hypothesis is possible. The drawback of using Bayes Factors for hypothesis testing is that they can only be usefully employed for clearly discrete alternatives of parameter values, as noted by <span class="citation">Gelman et al. (2014)</span>, p. 182. For continuous models with infinitely many parameter values between alternative hypotheses, the use of Bayes factors is not helpful.</p>
<div id="the-best-approach" class="section level3">
<h3>The BEST Approach</h3>
<p>Another way of Bayesian hypothesis testing is presented by <span class="citation">Kruschke (2013)</span>, who describes a Bayesian alternative to the frequentist t-test. This approach was extended to different types of hypothesis tests in the <strong>BayesianFirstAid</strong> R-package <span class="citation">(Bååth 2014)</span>, and this the approach followed for the <strong>bayesWilcoxTest</strong> package. Kruschke’s BEST (“Bayesian Estimation Supersedes the t Test”) procedure for the two-sample test models the data as Student’s t distributions with uninformative priors. The resulting posterior distributions for the <span class="math inline">\(\mu\)</span> parameter of both groups give the probabilies of the means exceeding or falling below any given value, and the probability of their differences …<br />
Advantages of this testing procedure, etc.</p>
</div>
<div id="the-frequentist-wilcoxon" class="section level3">
<h3>The Frequentist Wilcoxon</h3>
<p>Hypothesis tests such as the frequentist t-Test and BEST are based on the assumption that the data follow a Gaussian (for the frequentist test) or a Student’s t distribution (for BEST). In addition, the scale of measurement of the data needs to be an interval scale, which excludes data on an ordinal scale such as grades or ratings. For cases in which these assumptions are violated, non-parametric alternatives exist: the Wilcoxon Signed Rank test for paired samples, due to <span class="citation">Wilcoxon (1945)</span>, and the independent-sample Wilcoxon Rank Sum test, also known as the Mann-Whitney test, first proposed by <span class="citation">Wilcoxon (1945)</span> and further developed by <span class="citation">Mann and Whitney (1947)</span>.</p>
<p>In the following, a similar Bayesian testing procedure for the frequentist Wilcoxon Rank test will be presented.</p>
</div>
</div>
<div id="the-bayesian-wilcoxon-rank-test" class="section level2">
<h2>The Bayesian Wilcoxon Rank Test</h2>
<p>The present section describes the estimation procedure for Bayesian Alternative to the frequentist Wilcoxon Rank test which is implemented by the <strong>bayes.wilcox.test</strong> package.</p>
<div id="nonlinear-transformation-to-gaussian-quantiles" class="section level3">
<h3>Nonlinear transformation to Gaussian quantiles</h3>
<p>The Bayesian Wilcoxon test follows an estimation procedure outlined in <span class="citation">Gelman et al. (2014)</span> and further described in a blog post by Andrew Gelman <span class="citation">(Gelman 2015)</span> for a two-sample test. As in the frequentist Wilcoxon procedure, the data are substituted by their ranks. Subsequently, the ranks are transformed to quantiles of a standard Gaussian distribution by applying a Gaussian quantile function to the sequence</p>
<p><span class="math display">\[\frac{1}{2n}, \frac{3}{2n}, ..., \frac{2i-1}{2n}, ..., \frac{2n - 1}{2n}\]</span></p>
<p>which results in a discrete distribution which approaches a standard Gaussian distribution as <span class="math inline">\(n\)</span> increases. A similar approach has been proposed by <span class="citation">Van der Waerden (1953)</span>, who suggested using a sequence of equidistant points instead of the sequence (). The differences between the resulting transformed ranks for two groups can in turn be modeled as a Gaussian distribution.<br />
Via Bayesian estimation, a model with uninformative priors can be estimated in order to obtain a BEST-style hypothesis test.</p>
</div>
<div id="prior-distributions" class="section level3">
<h3>Prior Distributions</h3>
<p>For the two-sample case, both groups are modeled as independent Gaussian distributions. Thus, prior distributions for the mean and variance of both groups are required. In order to keep these priors uninformative, uniform distributions are employed, and since the distribution of the transformed ranks is known and depends only on the sample size, the upper and lower limits of the prior distributions can be derived.</p>
<p>For the variance, the lower limit is zero, since it is possible that all data from one group have the same value, resulting in the assignment of tied ranks which are all equal and thus a variance of zero. The maximum variance is realized if one group consists only of two data points, which at the same time are the highest and lowest value of both groups combined. The transformed ranks assigned to these two values depend on the overall sample size. The smallest transformed rank is given by <span class="math inline">\(Z_{min} = \Phi^{-1}(\frac{1}{2n})\)</span>, the largest by <span class="math inline">\(Z_{max} = \Phi^{-1}(\frac{2n-1}{2n})\)</span>. Due to the symmetry of the Gaussian quantile function, <span class="math inline">\(Z_{min} = -Z_{max}\)</span>, which implies a zero mean for the two values. The maximum variance is thus given by</p>
<p><span class="math display">\[\sigma^2_{max}(n) = \frac{1}{2}(\Phi^{-1}(\frac{2n-1}{2n}))^2 + 
\frac{1}{2}(\Phi^{-1}(\frac{2n-1}{2n}))^2 = (\Phi^{-1}(\frac{2n-1}{2n}))^2\]</span></p>
<p>which results in a maximum standard deviation of <span class="math inline">\(\sigma_{max}(n) = \Phi^{-1}(\frac{2n-1}{2n}) = -\Phi^{-1}(\frac{1}{2n})\)</span>.</p>
<p>The lowest possible mean for one of the two groups is realized if this group again consists only of two data points, which are the two lowest values of the overall data. Their transformed ranks would then be given by <span class="math inline">\(Z_{min1} = \Phi^{-1}(\frac{1}{2n})\)</span> and <span class="math inline">\(Z_{min2} = \Phi^{-1}(\frac{3}{2n})\)</span>, resulting in a lowest possible mean of</p>
<p><span class="math display">\[\mu_{min}(n) =  \frac{1}{2}(\Phi^{-1}(\frac{1}{2n}) +
\Phi^{-1}(\frac{3}{2n}))\]</span></p>
<p>and, due to symmetry of the quantile function, a highest possible mean of</p>
<p><span class="math display">\[\mu_{max}(n) =  -\frac{1}{2}(\Phi^{-1}(\frac{1}{2n}) +
\Phi^{-1}(\frac{3}{2n}))\]</span></p>
<p>The priors on the means for both groups are thus given by a uniform distribution … Since the</p>
<p>For the paired sample test, the single target posterior distribution is the difference between the transformed ranks of both groups. Again, uniformly distributed priors are employed for the mean and variance.</p>
<p>In the paired sample case, the variance depends on the ordering of the observations in the two groups. A value of zero can be realized if all values in the first group are smaller than all values in the second group, and both groups are sorted in ascending order. The difference in transformed ranks would then be the same for all pairs of values, resulting in a smallest possible variance of zero.<br />
As the variance depends on the ordering of the observations, the largest possible variance is more difficult to estimate exactly. The maximum variance of the differences in transformed ranks is larger than the variance of the individual transformed ranks, thus, a larger upper limit than in the two-sample case is required.<br />
<strong>bayesWilcoxTest</strong> uses the range of the transformed ranks as a rough estimate of the upper limit of the standard deviation, since the standard deviation cannot exceed this value here. The range of the transformed ranks is, due to symmetry, twice the largest of the transformed rank values, i.e. <span class="math display">\[ \sigma_{max}(n) = 2\Phi^{-1}(\frac{2n-1}{2n}) = -2\Phi^{-1}(\frac{1}{2n})\]</span></p>
<p>The largest and smallest possible mean of the differences in transformed ranks can be obtained in a more straightforward fashion. The smallest mean will be realized if all elements in <span class="math inline">\(x\)</span> are larger than all values in <span class="math inline">\(y\)</span>, and vice versa - due to symmetry, <span class="math inline">\(\mu_{min} = -\mu_{max}\)</span>. Calculating the possible means for <span class="math inline">\(x &gt; y\)</span> for different sample sizes reveals that <span class="math inline">\(\mu_{max}\)</span> converges to a value just below <span class="math inline">\(1.6\)</span>:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">pairDiff_means &lt;-<span class="st"> </span><span class="cf">function</span>(N) {
  <span class="co">#create x and y so that x &gt; y</span>
  x &lt;-<span class="st"> </span><span class="kw">seq</span>(<span class="fl">1.1</span>, <span class="fl">2.1</span>, <span class="dt">by =</span> (<span class="dv">1</span><span class="op">/</span>(N <span class="op">-</span><span class="st"> </span><span class="dv">1</span>)))
  y &lt;-<span class="st"> </span><span class="kw">seq</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="dt">by =</span> (<span class="dv">1</span><span class="op">/</span>(N <span class="op">-</span><span class="st"> </span><span class="dv">1</span>)))
  n &lt;-<span class="st"> </span><span class="kw">length</span>(x) <span class="op">+</span><span class="st"> </span><span class="kw">length</span>(y)
  ranks &lt;-<span class="st"> </span><span class="kw">rank</span>(<span class="kw">c</span>(x, y)) <span class="co"># Replace by ranks</span>
  <span class="co">#Tranformed Ranks</span>
  seqQ &lt;-<span class="st"> </span><span class="kw">seq</span>(<span class="dv">1</span>, <span class="dv">2</span><span class="op">*</span>n <span class="op">-</span><span class="st"> </span><span class="dv">1</span>, <span class="dt">by =</span> <span class="dv">2</span>)<span class="op">/</span>(<span class="dv">2</span><span class="op">*</span>n)
  zRanks &lt;-<span class="st"> </span><span class="kw">qnorm</span>(seqQ[ranks])
  zRanksX &lt;-<span class="st"> </span>zRanks[<span class="dv">1</span><span class="op">:</span><span class="kw">length</span>(x)]
  zRanksY &lt;-<span class="st"> </span>zRanks[<span class="op">-</span>(<span class="dv">1</span><span class="op">:</span><span class="kw">length</span>(x))]
  mean_diff &lt;-<span class="st"> </span><span class="kw">mean</span>(zRanksX <span class="op">-</span><span class="st"> </span>zRanksY)
  <span class="kw">return</span>(mean_diff)
}
means &lt;-<span class="st"> </span><span class="kw">c</span>()
<span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">2</span><span class="op">:</span><span class="dv">500</span>) {
  means &lt;-<span class="st"> </span><span class="kw">c</span>(means, <span class="kw">pairDiff_means</span>(i))
}
<span class="kw">plot</span>(means, <span class="dt">type =</span> <span class="st">&quot;l&quot;</span>, <span class="dt">ylab =</span> <span class="st">&quot;mu_max&quot;</span>,  <span class="dt">xlab =</span> <span class="st">&quot;N&quot;</span>)</code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>The upper and lower limits of the unifrom prior distribution for the mean of transformed differences are thus <span class="math inline">\(\mu_{min} = -1.6\)</span> and <span class="math inline">\(\mu_{max} = 1.6\)</span>.</p>
<p>For both the paired and independent sample case, initial values for the MCMC are set to <span class="math inline">\(\mu = 0\)</span> and <span class="math inline">\(\sigma = 1\)</span>, i.e., the values which are obtained under the null hypothesis.</p>
</div>
</div>
<div id="the-bayes.wilcox.test-package" class="section level2">
<h2>The bayes.wilcox.test Package</h2>
</div>
<div id="notes" class="section level2">
<h2>Notes</h2>
<p>Note: Consider Mann-Whitney Test! -&gt; test for two independent groups, also included in wilcox.test function</p>
<p>Gelman (blog post): “the Wilcoxon test has a huge assumption which is that the distributions are identical in the two groups. This is a much more important assumption than normality.” Cite blog post</p>
<p>“History of the idea”: <span class="citation">(Van der Waerden 1953)</span> introduced concept, but used equidistant points instead of quantiles. <span class="citation">(Gelman et al. 2014, 97)</span> using quantiles</p>
<p><span class="citation">(Kruschke 2013, 575)</span>: “In the case of data from a single group, including the case of a single group of difference scores from repeated measures on the same subjects, a modified model merely estimates <span class="math inline">\(\mu\)</span>, <span class="math inline">\(\sigma\)</span>, and <span class="math inline">\(\nu\)</span> of the group.” Crucial change from independent two paired sample test: two different <span class="math inline">\(\sigma\)</span>s vs. a single one See Kruschke’s 2011 discussion of oneway / twoway ANOVA!</p>
<p>Consider including effect size / How to deal with mu?</p>
</div>
<div id="references" class="section level2 unnumbered">
<h2>References</h2>
<div id="refs" class="references">
<div id="ref-baath2014bayesian">
<p>Bååth, Rasmus. 2014. “Bayesian First Aid: A Package That Implements Bayesian Alternatives to the Classical *.Test Functions in R.” In <em>UseR! 2014 - the International R User Conference</em>.</p>
</div>
<div id="ref-gelman2015dont">
<p>Gelman, Andrew. 2015. “Don’t Do the Wilcoxon.” <a href="http://andrewgelman.com/2015/07/13/dont-do-the-wilcoxon/" class="uri">http://andrewgelman.com/2015/07/13/dont-do-the-wilcoxon/</a>.</p>
</div>
<div id="ref-gelman2014bayesian">
<p>Gelman, Andrew, John B Carlin, Hal S Stern, David B Dunson, Aki Vehtari, and Donald B Rubin. 2014. <em>Bayesian Data Analysis</em>. 3rd ed. CRC press Boca Raton, FL.</p>
</div>
<div id="ref-kruschke2013bayesian">
<p>Kruschke, John K. 2013. “Bayesian Estimation Supersedes the T Test.” <em>Journal of Experimental Psychology: General</em> 142 (2). American Psychological Association: 573.</p>
</div>
<div id="ref-mann1947test">
<p>Mann, Henry B, and Donald R Whitney. 1947. “On a Test of Whether One of Two Random Variables Is Stochastically Larger Than the Other.” <em>The Annals of Mathematical Statistics</em>. JSTOR, 50–60.</p>
</div>
<div id="ref-van1953neuer">
<p>Van der Waerden, BL. 1953. “Ein Neuer Test Für Das Problem Der Zwei Stichproben.” <em>Mathematische Annalen</em> 126 (1). Springer: 93–107.</p>
</div>
<div id="ref-wilcoxon1945individual">
<p>Wilcoxon, Frank. 1945. “Individual Comparisons by Ranking Methods.” <em>Biometrics Bulletin</em> 1 (6). JSTOR: 80–83.</p>
</div>
</div>
</div>



<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
